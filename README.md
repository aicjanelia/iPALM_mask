# Reena Kumari -  iPALM

**Project:** Distinct actin filament populations in focal adhesions

**Dates:** 2022-03-07 - 2021-03-18

## Analysis Workflow
The current analysis tools are designed to work in tandem with the software PeakSelector, which allows for filtering of iPALM localizations and pixelated image rendering of the underlying data. The bead removal approach can be used separately from any downstream analysis to clean up localization data for better visualization in PeakSelector. The focal adhesion masking approach uses a separated pixelated image of paxillin to mask the iPALM localization data.

**Example Data:** Initial testing of the analysis pipeline was conducted on the file _Run1-561_c123_sum_X14_processed_purged_IDL.sav_ from the folder _22.03.08-1/Run1-561/_

**Acknowledgments:** The subfunctions `bpass`, `cntrd`, and `pkfnd` were adapted for MATLAB by [Daniel Blair and Eric Dufresne](https://site.physics.georgetown.edu/matlab/code.html) from the IDL Particle Tracking software developed by David Grier, John Crocker, and Eric Weeks.

### Bead Removal
Bead removal takes as input an image and txt file generated by PeakSelector and outputs a new txt file with localizations corresponding to beads removed. This txt file can be reloaded into PeakSelector for further exploration and visualization of the data.

To use this approach:
1. Load the data of interest into PeakSelector and ensure it is properly filtered. For example, set quaulity control settings such as sigma rtNPh < 0.06 or set bounds on the unwrapped z value.
2. Export the PeakSelector data as an ASCII file with the option of xy values in pixels.
3. Open the 'Cust. Tiff' menu and export the Total Raw Data as a tiff file with 133.33 nm per pixel.
4. Fill in appropriate filenames for the ASCII and tiff files under the USER PARAMETERS section of `beadRemoval_v0_anisotropic.m`.
5. Optionally adjust the parameters for bead removal:
    - `rRemoveX` and `rRemoveY` indicate the size of the region in pixels (133.33 nm/pixel) removed around each bead, in the X & Y directions respectively.
    - `rParticle` indicates the approximate size of beads in the total raw data image, in pixels.
    - `beadThresh` is a threshold for distinguishing beads from the background.
6. Run `beadRemoval_v0_anisotropic.m`. Figures will provide a check on the regions of data that were removed, and a new txt file will be generated without localizations from beads.

### Masking of iPALM Localizations
The masking script takes as input an image to use for masking and a txt file of localization data.  The localization data can be directly created in PeakSelector or can be the output of the Bead Removal step. The image to use for masking is assumed to be in a raw image format with an accompanying txt file providing image size information.

To use this approach:
1. Fill in appropriate filenames for the ASCII and .dat files under the USER PARAMETERS section of `focalAdhesionMask.m`.
2. Optionally adjust the parameters for thresholding the mask image:
    - `threshStrength` is multiplied by a calculated Otsu threshold for the image. Decreasing the threshold will pick up additional features and broader regions around each adhesion.
    - `minSize` is the minimum size, in pixels^2, of an object to keep in the mask.
3. Run `focalAdhesionMask.m`. A figure will provide a check on the thresholding, and two new txt files will be generated. The file ending in _masked.txt_ will contain only those localizations within the masked regions, while _mask2ndChannel.txt_ will contain the masked information as a second channel on top of the unchanged original localizations.

### Using txt files with PeakSelector
The output txt files can be reloaded into PeakSelctor through the menu option _Import User ASCII_ by choosing xy coords in pixels, checking the box for headers, and inputting the values 0 to 48 for the data columns (see the file _peakSelector_columnIndices_ for an easy list of values to copy and paste).
